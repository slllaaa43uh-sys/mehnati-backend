# ุฅุนุฏุงุฏ Cloudinary ูููุดุฑูุน

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุญุฏูุซ ุงููุดุฑูุน ูุงุณุชุฎุฏุงู **Cloudinary** ูุชุฎุฒูู ููุนุงูุฌุฉ ุงูุตูุฑ ูุงูููุฏูููุงุช ุจุฏูุงู ูู ุงูุชุฎุฒูู ุงููุญูู. ูุฐุง ูููุฑ:

- **ุชุฎุฒูู ุณุญุงุจู ููุซูู** ูููููุงุช
- **ูุนุงูุฌุฉ ุชููุงุฆูุฉ** ููุตูุฑ (ุถุบุทุ ุชุญุณูู ุงูุฌูุฏุฉุ ุชุญููู ุงูุชูุณูู)
- **ุชูุตูู ุณุฑูุน** ุนุจุฑ CDN ุนุงููู
- **ุฏุนู ุงูููุฏูู** ูุน ูุนุงูุฌุฉ ุชููุงุฆูุฉ
- **ุฅุฏุงุฑุฉ ุณููุฉ** ูููููุงุช ูู ููุญุฉ ุงูุชุญูู

---

## ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุงููุทููุจุฉ

ูุฌุจ ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ุงูุชุงููุฉ ูู ููู `.env` ุนูู ุงูุฎุงุฏู:

### 1. CLOUDINARY_CLOUD_NAME
**ุงููุตู:** ุงุณู ุงูุณุญุงุจุฉ ุงูุฎุงุต ุจู ูู Cloudinary  
**ูุซุงู:** `CLOUDINARY_CLOUD_NAME=dkj9e4low`  
**ููููุฉ ุงูุญุตูู ุนููู:**
- ุณุฌู ุฏุฎูู ุฅูู [Cloudinary Dashboard](https://cloudinary.com/console)
- ุณุชุฌุฏู ูู ุฃุนูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุชุญุช "Account Details"
- ุฃู ูู ุฑุงุจุท ุงูู URL ุงูุฐู ูุฏูุชู: `dkj9e4low`

---

### 2. CLOUDINARY_API_KEY
**ุงููุตู:** ููุชุงุญ API ูููุตูู ุฅูู ุญุณุงุจู  
**ูุซุงู:** `CLOUDINARY_API_KEY=123456789012345`  
**ููููุฉ ุงูุญุตูู ุนููู:**
- ูู ููุณ ุตูุญุฉ Dashboard
- ุชุญุช "Account Details" โ "API Key"
- ุฃู ูู ุงูุฑุงุจุท ุงูุฐู ูุฏูุชู: ุงุณุชุฎุฑุฌ ุงูุฌุฒุก ุจุนุฏ `://` ููุจู `:`

---

### 3. CLOUDINARY_API_SECRET
**ุงููุตู:** ุงูููุชุงุญ ุงูุณุฑู ูููุตุงุฏูุฉ  
**ูุซุงู:** `CLOUDINARY_API_SECRET=<your_api_secret_here>`  
**ููููุฉ ุงูุญุตูู ุนููู:**
- ูู ููุณ ุตูุญุฉ Dashboard
- ุชุญุช "Account Details" โ "API Secret"
- ุงููุฑ ุนูู "Reveal" ูุฅุธูุงุฑ ุงูููุชุงุญ
- ุฃู ูู ุงูุฑุงุจุท ุงูุฐู ูุฏูุชู: ุงุณุชุฎุฑุฌ ุงูุฌุฒุก ุจูู `:` ู `@`

โ๏ธ **ุชูุจูู ุฃููู:** ูุง ุชุถุน `CLOUDINARY_API_SECRET` ุฏุงุฎู Git/GitHub. ุงุณุชุฎุฏูู ููุท ุฏุงุฎู ููู `.env` ุนูู ุงูุฎุงุฏู.

---

## ููููุฉ ุงุณุชุฎุฑุงุฌ ุงููุชุบูุฑุงุช ูู ุงูุฑุงุจุท

ูุฏูู ุฑุงุจุท Cloudinary ุจูุฐุง ุงูุดูู:
```
cloudinary://<api_key>:<api_secret>@<cloud_name>
```

ูู ุงูุฑุงุจุท ุงูุฐู ูุฏูุชู:
```
cloudinary://<your_api_key>:<your_api_secret>@dkj9e4low
```

**ุงุณุชุฎุฑุงุฌ ุงูููู:**
- `CLOUDINARY_CLOUD_NAME` = `dkj9e4low` (ุงูุฌุฒุก ุจุนุฏ `@`)
- `CLOUDINARY_API_KEY` = ุงูุฌุฒุก ุจูู `://` ู `:`
- `CLOUDINARY_API_SECRET` = ุงูุฌุฒุก ุจูู `:` ู `@`

---

## ููู .env ุงูููุงุฆู

ุฃุถู ูุฐู ุงูุฃุณุทุฑ ุฅูู ููู `.env` ุนูู ุงูุฎุงุฏู:

```env
# Cloudinary Configuration
CLOUDINARY_CLOUD_NAME=dkj9e4low
CLOUDINARY_API_KEY=<your_api_key_here>
CLOUDINARY_API_SECRET=<your_api_secret_here>
```

โ๏ธ **ููู:** ุงุณุชุจุฏู `<your_api_key_here>` ุจุงูููุชุงุญ ุงููุนูู ูู ููุญุฉ ุงูุชุญูู.

---

## ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง

### 1. ุงููููุงุช ุงูุฌุฏูุฏุฉ
- โ `src/config/cloudinary.js` - ุฅุนุฏุงุฏุงุช Cloudinary
- โ `src/utils/cloudinaryHelper.js` - ูุธุงุฆู ูุณุงุนุฏุฉ ููุญุฐู

### 2. ุงููููุงุช ุงููุญุฏุซุฉ
- โ `src/middleware/upload.js` - ุงุณุชุฎุฏุงู Cloudinary Storage
- โ `src/controllers/postController.js` - ุญูุธ ุฑูุงุจุท Cloudinary
- โ `src/controllers/storyController.js` - ุญูุธ ุฑูุงุจุท Cloudinary
- โ `src/controllers/userController.js` - ุญูุธ ุงูุตูุฑ ุงูุดุฎุตูุฉ
- โ `src/models/Post.js` - ุฅุถุงูุฉ ุญูู `publicId`
- โ `src/models/Story.js` - ุฅุถุงูุฉ ุญูู `publicId`
- โ `package.json` - ุฅุถุงูุฉ ุญุฒู Cloudinary

### 3. ุงูุญุฒู ุงููุซุจุชุฉ
```json
{
  "cloudinary": "^2.x.x",
  "multer-storage-cloudinary": "^4.x.x"
}
```

---

## ุงููุฌูุฏุงุช ูู Cloudinary

ุณูุชู ุชูุธูู ุงููููุงุช ูู ุงููุฌูุฏุงุช ุงูุชุงููุฉ:

- ๐ `mehnati/posts` - ุตูุฑ ูููุฏูููุงุช ุงูููุดูุฑุงุช
- ๐ `mehnati/avatars` - ุงูุตูุฑ ุงูุดุฎุตูุฉ ูููุณุชุฎุฏููู
- ๐ `mehnati/stories` - ูุญุชูู ุงููุตุต

---

## ุงูููุฒุงุช ุงููุถุงูุฉ

### 1. ูุนุงูุฌุฉ ุชููุงุฆูุฉ ููุตูุฑ
- ุถุบุท ุชููุงุฆู ุจุฌูุฏุฉ ูุญุณูุฉ (`quality: auto`)
- ุชุญููู ุชููุงุฆู ูุฃูุถู ุชูุณูู (`fetch_format: auto`)
- ุชุบููุฑ ุญุฌู ุงูุตูุฑ ุงูุดุฎุตูุฉ ุฅูู 500ร500

### 2. ุฏุนู ุงูููุฏูู
- ุฑูุน ููุฏูููุงุช ุญุชู 100MB
- ูุนุงูุฌุฉ ุชููุงุฆูุฉ ููููุฏูู
- ุฏุนู ุตูุบ: MP4, WebM, MOV, AVI

### 3. ุฅุฏุงุฑุฉ ุงููููุงุช
- ุญูุธ `publicId` ููู ููู ูุณูููุฉ ุงูุญุฐู
- ูุธุงุฆู ูุณุงุนุฏุฉ ูุญุฐู ุงููููุงุช ูู Cloudinary
- ุงุณุชุฎุฑุงุฌ ุชููุงุฆู ููู `publicId` ูู ุงูุฑูุงุจุท

---

## ุฎุทูุงุช ุงููุดุฑ

### 1. ุชุญุฏูุซ ุงูููุฏ ุนูู ุงูุฎุงุฏู
```bash
cd /path/to/mehnati-backend
git pull origin main
npm install
```

### 2. ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ
```bash
nano .env
# ุฃุถู ุงููุชุบูุฑุงุช ุงูุซูุงุซุฉ ุงููุฐููุฑุฉ ุฃุนูุงู
```

### 3. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู
```bash
pm2 restart mehnati-backend
# ุฃู
npm run start
```

### 4. ุงูุชุญูู ูู ุงูุชุดุบูู
- ุฌุฑุจ ุฑูุน ุตูุฑุฉ ูู ุงูุชุทุจูู
- ุชุญูู ูู ุธููุฑูุง ูู [Cloudinary Media Library](https://cloudinary.com/console/media_library)
- ุชุฃูุฏ ูู ุนูู ุงูุฑูุงุจุท ุจุดูู ุตุญูุญ

---

## ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

**ุณ: ูู ูุฌุจ ุญุฐู ูุฌูุฏ `uploads` ุงููุญููุ**  
ุฌ: ููููู ุงูุงุญุชูุงุธ ุจู ูุคูุชุงูุ ููู ุงููููุงุช ุงูุฌุฏูุฏุฉ ุณุชูุญูุธ ูู Cloudinary ููุท.

**ุณ: ูุงุฐุง ุนู ุงูุตูุฑ ุงููุฏููุฉุ**  
ุฌ: ุงูุตูุฑ ุงููุฏููุฉ ูู `uploads` ุณุชุจูู ุชุนููุ ููู ูููุถู ููููุง ุฅูู Cloudinary ูุงุญูุงู.

**ุณ: ูู Cloudinary ูุฌุงููุ**  
ุฌ: ูุนูุ ูููุฑ ุฎุทุฉ ูุฌุงููุฉ ุณุฎูุฉ (25 GB ุชุฎุฒููุ 25 GB ููู ุจูุงูุงุช ุดูุฑูุงู).

**ุณ: ููู ุฃุญุฐู ููู ูู Cloudinaryุ**  
ุฌ: ุงุณุชุฎุฏู ุงููุธุงุฆู ูู `src/utils/cloudinaryHelper.js` ุฃู ูู ููุญุฉ ุงูุชุญูู.

---

## ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุตุญุฉ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ
2. ุฑุงุฌุน ุณุฌูุงุช ุงูุฎุงุฏู (`pm2 logs`)
3. ุชุฃูุฏ ูู ุชุซุจูุช ุงูุญุฒู ุจุดูู ุตุญูุญ
4. ุชุญูู ูู ุญุฏูุฏ ุงูุฎุทุฉ ูู Cloudinary

---

**ุชู ุงูุชุญุฏูุซ:** ุฏูุณูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 2.0.0 (ูุน ุฏุนู Cloudinary)
